<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free comprehensive financial calculators for mortgages, loans, investments, retirement planning, taxes, and more. Professional tools to help you make informed financial decisions.">
    <meta name="keywords" content="financial calculator, mortgage calculator, loan calculator, investment calculator, retirement calculator, tax calculator">
    <meta name="author" content="Financial Calculator Pro">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Financial Calculator Pro - Free Financial Calculators">
    <meta property="og:description" content="Professional financial calculators for all your money planning needs">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://financialcalculatorpro.com">
    
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Financial Calculator Pro">
    <meta name="twitter:description" content="Professional financial calculators for all your money planning needs">
    
    <title>Financial Calculator Pro - Free Professional Financial Calculators</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a'
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-slow': 'pulse 3s infinite'
                    }
                }
            }
        }
    </script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/heroicons@2.0.18/24/outline/index.js" type="module"></script>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3b82f6">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%233b82f6'><path d='M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21A2 2 0 0 0 5 23H19A2 2 0 0 0 21 21V9M19 9H14V4H19V9Z'/></svg>">

    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideUp {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
        }
        .dark .glass-effect {
            background: rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <!-- Navigation Header -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50 transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <div class="h-8 w-8 bg-primary-500 rounded-lg flex items-center justify-center mr-3">
                            <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21A2 2 0 0 0 5 23H19A2 2 0 0 0 21 21V9M19 9H14V4H19V9Z"/>
                            </svg>
                        </div>
                        <h1 class="text-xl font-bold text-gray-900 dark:text-white">Financial Calculator Pro</h1>
                    </div>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#home" class="nav-link active">Home</a>
                        <div class="relative group">
                            <button class="nav-link flex items-center">
                                Mortgage & Real Estate
                                <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
                                </svg>
                            </button>
                            <div class="dropdown-menu">
                                <a href="#mortgage-calculator" class="dropdown-link">Mortgage Calculator</a>
                                <a href="#amortization-calculator" class="dropdown-link">Amortization Calculator</a>
                                <a href="#affordability-calculator" class="dropdown-link">House Affordability</a>
                                <a href="#refinance-calculator" class="dropdown-link">Refinance Calculator</a>
                            </div>
                        </div>
                        <div class="relative group">
                            <button class="nav-link flex items-center">
                                Investment
                                <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
                                </svg>
                            </button>
                            <div class="dropdown-menu">
                                <a href="#investment-calculator" class="dropdown-link">Investment Calculator</a>
                                <a href="#compound-interest-calculator" class="dropdown-link">Compound Interest</a>
                                <a href="#savings-calculator" class="dropdown-link">Savings Calculator</a>
                                <a href="#roi-calculator" class="dropdown-link">ROI Calculator</a>
                            </div>
                        </div>
                        <div class="relative group">
                            <button class="nav-link flex items-center">
                                Retirement
                                <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
                                </svg>
                            </button>
                            <div class="dropdown-menu">
                                <a href="#retirement-calculator" class="dropdown-link">Retirement Calculator</a>
                                <a href="#401k-calculator" class="dropdown-link">401K Calculator</a>
                                <a href="#roth-ira-calculator" class="dropdown-link">Roth IRA Calculator</a>
                                <a href="#social-security-calculator" class="dropdown-link">Social Security</a>
                            </div>
                        </div>
                        <a href="#all-calculators" class="nav-link">All Calculators</a>
                    </div>
                </div>

                <!-- Search and Theme Toggle -->
                <div class="flex items-center space-x-4">
                    <!-- Search -->
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search calculators..." 
                               class="w-64 px-4 py-2 pl-10 pr-4 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                        <svg class="absolute left-3 top-2.5 h-4 w-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
                        </svg>
                    </div>

                    <!-- Theme Toggle -->
                    <button id="themeToggle" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                        <svg id="sunIcon" class="h-5 w-5 text-gray-800 dark:text-gray-200" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>
                        </svg>
                    </button>

                    <!-- Mobile Menu Button -->
                    <button id="mobileMenuBtn" class="md:hidden p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700">
                        <svg class="h-6 w-6 text-gray-800 dark:text-gray-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="md:hidden hidden bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#home" class="mobile-nav-link">Home</a>
                <a href="#mortgage-calculator" class="mobile-nav-link">Mortgage Calculator</a>
                <a href="#investment-calculator" class="mobile-nav-link">Investment Calculator</a>
                <a href="#retirement-calculator" class="mobile-nav-link">Retirement Calculator</a>
                <a href="#all-calculators" class="mobile-nav-link">All Calculators</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="bg-gradient-to-br from-primary-50 to-blue-100 dark:from-gray-800 dark:to-gray-900 py-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl md:text-6xl font-bold text-gray-900 dark:text-white mb-6 animate-fade-in">
                    Professional Financial Calculators
                </h1>
                <p class="text-xl text-gray-600 dark:text-gray-300 mb-8 max-w-3xl mx-auto animate-fade-in">
                    Make informed financial decisions with our comprehensive suite of professional calculators. 
                    From mortgages to investments, we've got all your financial planning needs covered.
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4 animate-fade-in">
                    <a href="#mortgage-calculator" class="btn-primary">
                        Start with Mortgage Calculator
                    </a>
                    <a href="#all-calculators" class="btn-secondary">
                        View All Calculators
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Calculators -->
    <section class="py-20 bg-white dark:bg-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">Most Popular Calculators</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Mortgage Calculator Card -->
                <div class="calculator-card" onclick="openCalculator('mortgage')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="h-12 w-12 bg-primary-100 dark:bg-primary-900 rounded-lg flex items-center justify-center mr-4">
                                <svg class="h-6 w-6 text-primary-600 dark:text-primary-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Mortgage Calculator</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Calculate monthly payments, interest, and amortization for your home loan.</p>
                        <span class="inline-flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-700">
                            Calculate Now
                            <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </span>
                    </div>
                </div>

                <!-- Investment Calculator Card -->
                <div class="calculator-card" onclick="openCalculator('investment')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="h-12 w-12 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mr-4">
                                <svg class="h-6 w-6 text-green-600 dark:text-green-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Investment Calculator</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Plan your investment strategy and calculate potential returns over time.</p>
                        <span class="inline-flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-700">
                            Calculate Now
                            <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </span>
                    </div>
                </div>

                <!-- Retirement Calculator Card -->
                <div class="calculator-card" onclick="openCalculator('retirement')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="h-12 w-12 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mr-4">
                                <svg class="h-6 w-6 text-purple-600 dark:text-purple-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z"/>
                                </svg>
                            </div>
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Retirement Calculator</h3>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 mb-4">Plan for your golden years and ensure a comfortable retirement.</p>
                        <span class="inline-flex items-center text-primary-600 dark:text-primary-400 hover:text-primary-700">
                            Calculate Now
                            <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculator Modal -->
    <div id="calculatorModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-6xl w-full max-h-screen overflow-y-auto">
                <!-- Modal Header -->
                <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                    <div>
                        <h2 id="modalTitle" class="text-2xl font-bold text-gray-900 dark:text-white">Calculator</h2>
                        <nav id="breadcrumb" class="text-sm text-gray-500 dark:text-gray-400 mt-1"></nav>
                    </div>
                    <button id="closeModal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200">
                        <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <!-- Modal Content -->
                <div id="modalContent" class="p-6">
                    <!-- Calculator content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- All Calculators Section -->
    <section id="all-calculators" class="py-20 bg-gray-50 dark:bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold text-center text-gray-900 dark:text-white mb-12">All Financial Calculators</h2>
            
            <!-- Category Tabs -->
            <div class="flex flex-wrap justify-center mb-8 border-b border-gray-200 dark:border-gray-700">
                <button class="category-tab active" data-category="all">All Calculators</button>
                <button class="category-tab" data-category="mortgage">Mortgage & Real Estate</button>
                <button class="category-tab" data-category="auto">Auto</button>
                <button class="category-tab" data-category="investment">Investment</button>
                <button class="category-tab" data-category="retirement">Retirement</button>
                <button class="category-tab" data-category="tax">Tax & Salary</button>
                <button class="category-tab" data-category="other">Other Tools</button>
            </div>

            <!-- Calculators Grid -->
            <div id="calculatorsGrid" class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Calculator cards will be generated here -->
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-20 bg-white dark:bg-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Why Choose Our Calculators?</h2>
                <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
                    Professional-grade financial tools designed to help you make better financial decisions
                </p>
            </div>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="h-16 w-16 bg-primary-100 dark:bg-primary-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="h-8 w-8 text-primary-600 dark:text-primary-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Accurate Calculations</h3>
                    <p class="text-gray-600 dark:text-gray-300">Professional formulas ensure precise results for all your financial planning needs.</p>
                </div>
                
                <div class="text-center">
                    <div class="h-16 w-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="h-8 w-8 text-green-600 dark:text-green-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C14.8,12.4 14.4,13.2 13.7,13.7V16.2C13.7,16.7 13.3,17.1 12.8,17.1H11.2C10.7,17.1 10.3,16.7 10.3,16.2V13.7C9.6,13.2 9.2,12.4 9.2,11.5V10C9.2,8.6 10.6,7 12,7Z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Secure & Private</h3>
                    <p class="text-gray-600 dark:text-gray-300">Your financial data stays on your device. No personal information is stored or transmitted.</p>
                </div>
                
                <div class="text-center">
                    <div class="h-16 w-16 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="h-8 w-8 text-purple-600 dark:text-purple-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M17,8C8,10 5.9,16.17 3.82,21.34L5.71,22L6.66,19.7C7.14,19.87 7.64,20 8,20C19,20 22,3 22,3C21,5 14,5.25 9,6.25C4,7.25 2,11.5 2,13.5C2,15.5 3.75,17.25 3.75,17.25C7,8 17,8 17,8Z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Fast & Responsive</h3>
                    <p class="text-gray-600 dark:text-gray-300">Instant calculations with real-time updates as you adjust your inputs.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 dark:bg-black text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-4 gap-8">
                <div class="md:col-span-2">
                    <div class="flex items-center mb-4">
                        <div class="h-8 w-8 bg-primary-500 rounded-lg flex items-center justify-center mr-3">
                            <svg class="h-5 w-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                             <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1H5C3.89 1 3 1.89 3 3V21A2 2 0 0 0 5 23H19A2 2 0 0 0 21 21V9M19 9H14V4H19V9Z"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold">Financial Calculator Pro</h3>
                    </div>
                    <p class="text-gray-300 mb-6 max-w-md">
                        Professional financial calculators to help you make informed decisions about mortgages, investments, 
                        retirement planning, and more. Free, secure, and easy to use.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
                            </svg>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/>
                            </svg>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Popular Calculators</h4>
                    <ul class="space-y-2">
                        <li><a href="#mortgage-calculator" class="text-gray-300 hover:text-white transition-colors">Mortgage Calculator</a></li>
                        <li><a href="#investment-calculator" class="text-gray-300 hover:text-white transition-colors">Investment Calculator</a></li>
                        <li><a href="#retirement-calculator" class="text-gray-300 hover:text-white transition-colors">Retirement Calculator</a></li>
                        <li><a href="#loan-calculator" class="text-gray-300 hover:text-white transition-colors">Loan Calculator</a></li>
                        <li><a href="#savings-calculator" class="text-gray-300 hover:text-white transition-colors">Savings Calculator</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-4">Resources</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-300 hover:text-white transition-colors">Financial Planning Guide</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition-colors">Investment Basics</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition-colors">Retirement Planning</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition-colors">Tax Planning</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition-colors">About Us</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-12 pt-8 text-center text-gray-400">
                <p>&copy; 2024 Financial Calculator Pro. All rights reserved. | 
                   <a href="#" class="hover:text-white transition-colors">Privacy Policy</a> | 
                   <a href="#" class="hover:text-white transition-colors">Terms of Service</a>
                </p>
            </div>
        </div>
    </footer>

    <style>
        /* Navigation Styles */
        .nav-link {
            @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors;
        }
        .nav-link.active {
            @apply text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900;
        }
        .mobile-nav-link {
            @apply block px-3 py-2 rounded-md text-base font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors;
        }
        
        /* Dropdown Styles */
        .dropdown-menu {
            @apply absolute top-full left-0 mt-1 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50;
        }
        .dropdown-link {
            @apply block px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-colors;
        }
        .dropdown-link:first-child {
            @apply rounded-t-md;
        }
        .dropdown-link:last-child {
            @apply rounded-b-md;
        }
        
        /* Button Styles */
        .btn-primary {
            @apply inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors shadow-md;
        }
        .btn-secondary {
            @apply inline-flex items-center px-6 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors;
        }
        
        /* Calculator Card Styles */
        .calculator-card {
            @apply bg-white dark:bg-gray-700 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:-translate-y-1 border border-gray-200 dark:border-gray-600;
        }
        
        /* Category Tab Styles */
        .category-tab {
            @apply px-4 py-2 mx-1 mb-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white border-b-2 border-transparent hover:border-primary-300 transition-colors;
        }
        .category-tab.active {
            @apply text-primary-600 dark:text-primary-400 border-primary-500;
        }
        
        /* Form Styles */
        .form-input {
            @apply w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-colors;
        }
        .form-label {
            @apply block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2;
        }
        .form-group {
            @apply mb-4;
        }
        
        /* Result Styles */
        .result-card {
            @apply bg-primary-50 dark:bg-primary-900 rounded-lg p-6 border border-primary-200 dark:border-primary-700;
        }
        .result-value {
            @apply text-3xl font-bold text-primary-600 dark:text-primary-400;
        }
        .result-label {
            @apply text-sm text-gray-600 dark:text-gray-400;
        }
    </style>

    <script>
        // Application State
        let currentCalculator = null;
        let calculationHistory = [];
        let isDarkMode = localStorage.getItem('darkMode') === 'true';

        // Calculator Definitions
        const calculators = {
            // Mortgage & Real Estate
            'mortgage': {
                title: 'Mortgage Calculator',
                category: 'mortgage',
                description: 'Calculate monthly mortgage payments, total interest, and amortization schedule'
            },
            'amortization': {
                title: 'Amortization Calculator',
                category: 'mortgage',
                description: 'View detailed payment schedule and principal vs interest breakdown'
            },
            'affordability': {
                title: 'House Affordability Calculator',
                category: 'mortgage',
                description: 'Determine how much house you can afford based on income and expenses'
            },
            'refinance': {
                title: 'Refinance Calculator',
                category: 'mortgage',
                description: 'Compare current mortgage with refinancing options'
            },
            'rent-calculator': {
                title: 'Rent Calculator',
                category: 'mortgage',
                description: 'Calculate fair rent based on property value and expenses'
            },
            'debt-to-income': {
                title: 'Debt-to-Income Ratio Calculator',
                category: 'mortgage',
                description: 'Calculate your debt-to-income ratio for loan qualification'
            },
            'real-estate': {
                title: 'Real Estate Calculator',
                category: 'mortgage',
                description: 'Analyze real estate investment returns and cash flow'
            },
            'rental-property': {
                title: 'Rental Property Calculator',
                category: 'mortgage',
                description: 'Evaluate rental property investment potential'
            },
            'apr': {
                title: 'APR Calculator',
                category: 'mortgage',
                description: 'Calculate Annual Percentage Rate including fees and costs'
            },
            'fha-loan': {
                title: 'FHA Loan Calculator',
                category: 'mortgage',
                description: 'Calculate FHA loan payments and requirements'
            },
            'va-mortgage': {
                title: 'VA Mortgage Calculator',
                category: 'mortgage',
                description: 'Calculate VA loan benefits and payments'
            },
            'down-payment': {
                title: 'Down Payment Calculator',
                category: 'mortgage',
                description: 'Determine optimal down payment amount'
            },
            'rent-vs-buy': {
                title: 'Rent vs. Buy Calculator',
                category: 'mortgage',
                description: 'Compare renting versus buying costs over time'
            },

            // Auto
            'auto-loan': {
                title: 'Auto Loan Calculator',
                category: 'auto',
                description: 'Calculate car loan payments and total cost'
            },
            'cash-back-vs-low-interest': {
                title: 'Cash Back or Low Interest Calculator',
                category: 'auto',
                description: 'Compare cash rebate vs low interest rate offers'
            },
            'auto-lease': {
                title: 'Auto Lease Calculator',
                category: 'auto',
                description: 'Calculate monthly lease payments and compare to buying'
            },

            // Investment
            'investment': {
                title: 'Investment Calculator',
                category: 'investment',
                description: 'Calculate investment growth with regular contributions'
            },
            'compound-interest': {
                title: 'Compound Interest Calculator',
                category: 'investment',
                description: 'See the power of compound interest over time'
            },
            'interest': {
                title: 'Interest Calculator',
                category: 'investment',
                description: 'Calculate simple and compound interest'
            },
            'finance': {
                title: 'Finance Calculator',
                category: 'investment',
                description: 'General financial calculations and planning'
            },
            'interest-rate': {
                title: 'Interest Rate Calculator',
                category: 'investment',
                description: 'Calculate interest rates for loans and investments'
            },
            'savings': {
                title: 'Savings Calculator',
                category: 'investment',
                description: 'Plan your savings goals and timeline'
            },
            'simple-interest': {
                title: 'Simple Interest Calculator',
                category: 'investment',
                description: 'Calculate simple interest on investments'
            },
            'cd': {
                title: 'CD Calculator',
                category: 'investment',
                description: 'Calculate Certificate of Deposit returns'
            },
            'bond': {
                title: 'Bond Calculator',
                category: 'investment',
                description: 'Calculate bond yields and returns'
            },
            'average-return': {
                title: 'Average Return Calculator',
                category: 'investment',
                description: 'Calculate average investment returns'
            },
            'irr': {
                title: 'IRR Calculator',
                category: 'investment',
                description: 'Calculate Internal Rate of Return'
            },
            'roi': {
                title: 'ROI Calculator',
                category: 'investment',
                description: 'Calculate Return on Investment'
            },
            'payback-period': {
                title: 'Payback Period Calculator',
                category: 'investment',
                description: 'Calculate investment payback period'
            },
            'present-value': {
                title: 'Present Value Calculator',
                category: 'investment',
                description: 'Calculate present value of future cash flows'
            },
            'future-value': {
                title: 'Future Value Calculator',
                category: 'investment',
                description: 'Calculate future value of investments'
            },

            // Retirement
            'retirement': {
                title: 'Retirement Calculator',
                category: 'retirement',
                description: 'Plan for retirement and calculate savings needs'
            },
            '401k': {
                title: '401K Calculator',
                category: 'retirement',
                description: 'Calculate 401k contributions and growth'
            },
            'pension': {
                title: 'Pension Calculator',
                category: 'retirement',
                description: 'Calculate pension benefits and payments'
            },
            'social-security': {
                title: 'Social Security Calculator',
                category: 'retirement',
                description: 'Estimate Social Security benefits'
            },
            'annuity': {
                title: 'Annuity Calculator',
                category: 'retirement',
                description: 'Calculate annuity payments and values'
            },
            'annuity-payout': {
                title: 'Annuity Payout Calculator',
                category: 'retirement',
                description: 'Calculate annuity payout options'
            },
            'roth-ira': {
                title: 'Roth IRA Calculator',
                category: 'retirement',
                description: 'Calculate Roth IRA contributions and growth'
            },
            'ira': {
                title: 'IRA Calculator',
                category: 'retirement',
                description: 'Calculate traditional IRA benefits'
            },
            'rmd': {
                title: 'RMD Calculator',
                category: 'retirement',
                description: 'Calculate Required Minimum Distributions'
            },

            // Tax & Salary
            'income-tax': {
                title: 'Income Tax Calculator',
                category: 'tax',
                description: 'Calculate federal and state income taxes'
            },
            'salary': {
                title: 'Salary Calculator',
                category: 'tax',
                description: 'Convert between salary, hourly, and other pay periods'
            },
            'marriage-tax': {
                title: 'Marriage Tax Calculator',
                category: 'tax',
                description: 'Compare tax implications of marriage'
            },
            'estate-tax': {
                title: 'Estate Tax Calculator',
                category: 'tax',
                description: 'Calculate estate tax obligations'
            },
            'take-home-paycheck': {
                title: 'Take-Home-Paycheck Calculator',
                category: 'tax',
                description: 'Calculate net pay after taxes and deductions'
            },

            // Other Financial Tools
            'loan': {
                title: 'Loan Calculator',
                category: 'other',
                description: 'Calculate loan payments for any type of loan'
            },
            'payment': {
                title: 'Payment Calculator',
                category: 'other',
                description: 'Calculate payments for loans and financing'
            },
            'currency': {
                title: 'Currency Calculator',
                category: 'other',
                description: 'Convert between different currencies'
            },
            'inflation': {
                title: 'Inflation Calculator',
                category: 'other',
                description: 'Calculate inflation impact on purchasing power'
            },
            'sales-tax': {
                title: 'Sales Tax Calculator',
                category: 'other',
                description: 'Calculate sales tax on purchases'
            },
            'credit-card': {
                title: 'Credit Card Calculator',
                category: 'other',
                description: 'Calculate credit card payments and payoff time'
            },
            'credit-card-payoff': {
                title: 'Credit Cards Payoff Calculator',
                category: 'other',
                description: 'Plan credit card debt payoff strategy'
            },
            'debt-payoff': {
                title: 'Debt Payoff Calculator',
                category: 'other',
                description: 'Create debt payoff plan and timeline'
            },
            'debt-consolidation': {
                title: 'Debt Consolidation Calculator',
                category: 'other',
                description: 'Compare debt consolidation options'
            },
            'repayment': {
                title: 'Repayment Calculator',
                category: 'other',
                description: 'Calculate loan repayment schedules'
            },
            'student-loan': {
                title: 'Student Loan Calculator',
                category: 'other',
                description: 'Calculate student loan payments and payoff'
            },
            'college-cost': {
                title: 'College Cost Calculator',
                category: 'other',
                description: 'Plan and calculate college expenses'
            },
            'vat': {
                title: 'VAT Calculator',
                category: 'other',
                description: 'Calculate Value Added Tax'
            },
            'depreciation': {
                title: 'Depreciation Calculator',
                category: 'other',
                description: 'Calculate asset depreciation over time'
            },
            'margin': {
                title: 'Margin Calculator',
                category: 'other',
                description: 'Calculate profit margins and markups'
            },
            'discount': {
                title: 'Discount Calculator',
                category: 'other',
                description: 'Calculate discounts and sale prices'
            },
            'business-loan': {
                title: 'Business Loan Calculator',
                category: 'other',
                description: 'Calculate business loan payments'
            },
            'personal-loan': {
                title: 'Personal Loan Calculator',
                category: 'other',
                description: 'Calculate personal loan options'
            },
            'boat-loan': {
                title: 'Boat Loan Calculator',
                category: 'other',
                description: 'Calculate boat financing options'
            },
            'lease': {
                title: 'Lease Calculator',
                category: 'other',
                description: 'Calculate lease payments for equipment'
            },
            'budget': {
                title: 'Budget Calculator',
                category: 'other',
                description: 'Create and manage personal budgets'
            },
            'commission': {
                title: 'Commission Calculator',
                category: 'other',
                description: 'Calculate sales commissions'
            }
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            generateCalculatorGrid();
            attachEventListeners();
            loadRecentCalculations();
        });

        // Theme Management
        function initializeTheme() {
            if (isDarkMode || (!('darkMode' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
                isDarkMode = true;
            }
            updateThemeIcon();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', isDarkMode);
            updateThemeIcon();
        }

        function updateThemeIcon() {
            const sunIcon = document.getElementById('sunIcon');
            if (isDarkMode) {
                sunIcon.innerHTML = `<path fill-rule="evenodd" d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" clip-rule="evenodd"/>`;
            } else {
                sunIcon.innerHTML = `<path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"/>`;
            }
        }

        // Event Listeners
        function attachEventListeners() {
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);
            
            // Mobile menu
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            
            // Modal close
            document.getElementById('closeModal').addEventListener('click', closeCalculatorModal);
            
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            
            // Category tabs
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', () => filterByCategory(tab.dataset.category));
            });
            
            // Close modal on outside click
            document.getElementById('calculatorModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeCalculatorModal();
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && document.getElementById('calculatorModal').classList.contains('hidden') === false) {
                    closeCalculatorModal();
                }
                if (e.ctrlKey && e.key === '/') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
            });
        }

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        }

        // Calculator Grid Generation
        function generateCalculatorGrid() {
            const grid = document.getElementById('calculatorsGrid');
            const calculatorCards = Object.keys(calculators).map(key => {
                const calc = calculators[key];
                return createCalculatorCard(key, calc);
            }).join('');
            
            grid.innerHTML = calculatorCards;
        }

        function createCalculatorCard(key, calculator) {
            const icons = {
                mortgage: 'M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z',
                auto: 'M5,11L6.5,6.5H17.5L19,11H5M17.5,16A1.5,1.5 0 0,1 16,14.5A1.5,1.5 0 0,1 17.5,13A1.5,1.5 0 0,1 19,14.5A1.5,1.5 0 0,1 17.5,16M6.5,16A1.5,1.5 0 0,1 5,14.5A1.5,1.5 0 0,1 6.5,13A1.5,1.5 0 0,1 8,14.5A1.5,1.5 0 0,1 6.5,16M18.92,6C18.72,5.42 18.16,5 17.5,5H6.5C5.84,5 5.28,5.42 5.08,6L3,12V20A1,1 0 0,0 4,21H5A1,1 0 0,0 6,20V19H18V20A1,1 0 0,0 19,21H20A1,1 0 0,0 21,20V12L18.92,6Z',
                investment: 'M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z',
                retirement: 'M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z',
                tax: 'M5,3V7H7V5H17V7H19V3H5M5,9V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V9H5M7,11H17V19H7V11M9,13V17H11V13H9M13,13V17H15V13H13Z',
                other: 'M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z'
            };

            const categoryColors = {
                mortgage: 'blue',
                auto: 'green',
                investment: 'purple',
                retirement: 'indigo',
                tax: 'red',
                other: 'gray'
            };

            const color = categoryColors[calculator.category] || 'gray';
            const icon = icons[calculator.category] || icons.other;

            return `
                <div class="calculator-card" data-category="${calculator.category}" data-name="${calculator.title.toLowerCase()}" onclick="openCalculator('${key}')">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <div class="h-12 w-12 bg-${color}-100 dark:bg-${color}-900 rounded-lg flex items-center justify-center mr-4">
                                <svg class="h-6 w-6 text-${color}-600 dark:text-${color}-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="${icon}"/>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-1">${calculator.title}</h3>
                                <span class="text-xs text-${color}-600 dark:text-${color}-400 font-medium uppercase tracking-wide">${calculator.category.replace('-', ' & ')}</span>
                            </div>
                        </div>
                        <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">${calculator.description}</p>
                        <div class="flex items-center justify-between">
                            <span class="inline-flex items-center text-${color}-600 dark:text-${color}-400 hover:text-${color}-700 text-sm font-medium">
                                Calculate Now
                                <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </span>
                            <button class="text-gray-400 hover:text-red-500 transition-colors" onclick="event.stopPropagation(); toggleFavorite('${key}')" title="Add to favorites">
                                <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Category Filtering
        function filterByCategory(category) {
            document.querySelectorAll('.category-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            const cards = document.querySelectorAll('.calculator-card');
            cards.forEach(card => {
                if (category === 'all' || card.dataset.category === category) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Search Functionality
        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase();
            const cards = document.querySelectorAll('.calculator-card');
            
            cards.forEach(card => {
                const name = card.dataset.name;
                const category = card.dataset.category;
                const title = card.querySelector('h3').textContent.toLowerCase();
                const description = card.querySelector('p').textContent.toLowerCase();
                
                if (name.includes(searchTerm) || 
                    category.includes(searchTerm) || 
                    title.includes(searchTerm) || 
                    description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Calculator Modal Management
        function openCalculator(calculatorKey) {
            currentCalculator = calculatorKey;
            const calculator = calculators[calculatorKey];
            
            if (!calculator) {
                console.error('Calculator not found:', calculatorKey);
                return;
            }

            document.getElementById('modalTitle').textContent = calculator.title;
            document.getElementById('breadcrumb').innerHTML = `
                <a href="#" class="hover:text-gray-700 dark:hover:text-gray-300">Home</a> > 
                <a href="#" class="hover:text-gray-700 dark:hover:text-gray-300">${calculator.category}</a> > 
                <span class="text-gray-700 dark:text-gray-300">${calculator.title}</span>
            `;
            
            document.getElementById('modalContent').innerHTML = getCalculatorContent(calculatorKey);
            document.getElementById('calculatorModal').classList.remove('hidden');
            
            // Initialize calculator-specific functionality
            initializeCalculator(calculatorKey);
            
            // Save to recent calculations
            saveToRecent(calculatorKey);
        }

        function closeCalculatorModal() {
            document.getElementById('calculatorModal').classList.add('hidden');
            currentCalculator = null;
        }

        // Calculator Content Generator
        function getCalculatorContent(calculatorKey) {
            switch(calculatorKey) {
                case 'mortgage':
                    return getMortgageCalculatorHTML();
                case 'investment':
                    return getInvestmentCalculatorHTML();
                case 'retirement':
                    return getRetirementCalculatorHTML();
                case 'compound-interest':
                    return getCompoundInterestCalculatorHTML();
                case 'loan':
                    return getLoanCalculatorHTML();
                case 'savings':
                    return getSavingsCalculatorHTML();
                default:
                    return getGenericCalculatorHTML(calculatorKey);
            }
        }

        // Mortgage Calculator HTML
        function getMortgageCalculatorHTML() {
            return `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Loan Details</h3>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Home Price ($)</label>
                                    <input type="number" id="homePrice" class="form-input" value="400000" min="0" step="1000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Down Payment ($)</label>
                                    <input type="number" id="downPayment" class="form-input" value="80000" min="0" step="1000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Down Payment (%)</label>
                                    <input type="number" id="downPaymentPercent" class="form-input" value="20" min="0" max="100" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Loan Amount ($)</label>
                                    <input type="number" id="loanAmount" class="form-input" value="320000" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Interest Rate (%)</label>
                                    <input type="number" id="interestRate" class="form-input" value="6.5" min="0" max="20" step="0.001">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Loan Term (years)</label>
                                    <select id="loanTerm" class="form-input">
                                        <option value="30">30 years</option>
                                        <option value="25">25 years</option>
                                        <option value="20">20 years</option>
                                        <option value="15">15 years</option>
                                        <option value="10">10 years</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Additional Costs (Optional)</h3>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Property Tax ($/year)</label>
                                    <input type="number" id="propertyTax" class="form-input" value="6000" min="0" step="100">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Home Insurance ($/year)</label>
                                    <input type="number" id="homeInsurance" class="form-input" value="1200" min="0" step="50">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">PMI ($/month)</label>
                                    <input type="number" id="pmi" class="form-input" value="200" min="0" step="10">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">HOA Fees ($/month)</label>
                                    <input type="number" id="hoaFees" class="form-input" value="0" min="0" step="10">
                                </div>
                            </div>
                        </div>

                        <div class="flex space-x-4">
                            <button onclick="calculateMortgage()" class="btn-primary flex-1">Calculate Payment</button>
                            <button onclick="resetMortgageForm()" class="btn-secondary">Reset</button>
                            <button onclick="printResults()" class="btn-secondary">Print</button>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div id="mortgageResults" class="result-card">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Monthly Payment Breakdown</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div class="text-center">
                                    <div class="result-value" id="monthlyPayment">$0</div>
                                    <div class="result-label">Principal & Interest</div>
                                </div>
                                <div class="text-center">
                                    <div class="result-value" id="totalMonthlyPayment">$0</div>
                                    <div class="result-label">Total Monthly Payment</div>
                                </div>
                            </div>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span>Principal & Interest:</span>
                                    <span id="piPayment">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Property Tax:</span>
                                    <span id="monthlyPropertyTax">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Home Insurance:</span>
                                    <span id="monthlyInsurance">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>PMI:</span>
                                    <span id="monthlyPMI">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>HOA Fees:</span>
                                    <span id="monthlyHOA">$0</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Loan Summary</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Total Interest Paid:</span>
                                    <span id="totalInterest" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Total Payments:</span>
                                    <span id="totalPayments" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Payoff Date:</span>
                                    <span id="payoffDate" class="font-semibold">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Payment Chart</h3>
                            <canvas id="mortgageChart" height="200"></canvas>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Amortization Schedule</h3>
                                <button onclick="showFullAmortization()" class="text-primary-600 dark:text-primary-400 hover:underline text-sm">View Full Schedule</button>
                            </div>
                            <div id="amortizationPreview" class="overflow-x-auto">
                                <!-- Amortization table will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Investment Calculator HTML
        function getInvestmentCalculatorHTML() {
            return `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Investment Parameters</h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">Initial Investment ($)</label>
                                    <input type="number" id="initialInvestment" class="form-input" value="10000" min="0" step="100">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Monthly Contribution ($)</label>
                                    <input type="number" id="monthlyContribution" class="form-input" value="500" min="0" step="50">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Annual Interest Rate (%)</label>
                                    <input type="number" id="annualRate" class="form-input" value="8" min="0" max="50" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Time Period (years)</label>
                                    <input type="number" id="investmentYears" class="form-input" value="20" min="1" max="50" step="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Compound Frequency</label>
                                    <select id="compoundFreq" class="form-input">
                                        <option value="1">Annually</option>
                                        <option value="4">Quarterly</option>
                                        <option value="12" selected>Monthly</option>
                                        <option value="365">Daily</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex space-x-4">
                            <button onclick="calculateInvestment()" class="btn-primary flex-1">Calculate Returns</button>
                            <button onclick="resetInvestmentForm()" class="btn-secondary">Reset</button>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div id="investmentResults" class="result-card">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Investment Results</h3>
                            <div class="grid grid-cols-1 gap-4 mb-4">
                                <div class="text-center">
                                    <div class="result-value" id="finalAmount">$0</div>
                                    <div class="result-label">Final Amount</div>
                                </div>
                            </div>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span>Total Contributions:</span>
                                    <span id="totalContributions" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Total Interest Earned:</span>
                                    <span id="totalInterestEarned" class="font-semibold text-green-600">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Total Return (%):</span>
                                    <span id="totalReturn" class="font-semibold">0%</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Growth Chart</h3>
                            <canvas id="investmentChart" height="250"></canvas>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Year-by-Year Breakdown</h3>
                            <div id="yearlyBreakdown" class="overflow-x-auto max-h-64 overflow-y-auto">
                                <!-- Yearly breakdown table will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Retirement Calculator HTML
        function getRetirementCalculatorHTML() {
            return `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Current Information</h3>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Current Age</label>
                                    <input type="number" id="currentAge" class="form-input" value="30" min="18" max="100" step="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Retirement Age</label>
                                    <input type="number" id="retirementAge" class="form-input" value="65" min="50" max="100" step="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Current Savings ($)</label>
                                    <input type="number" id="currentSavings" class="form-input" value="50000" min="0" step="1000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Monthly Contribution ($)</label>
                                    <input type="number" id="monthlyRetirementContrib" class="form-input" value="1000" min="0" step="50">
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Retirement Goals</h3>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label class="form-label">Desired Annual Income ($)</label>
                                    <input type="number" id="desiredIncome" class="form-input" value="60000" min="0" step="1000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Life Expectancy</label>
                                    <input type="number" id="lifeExpectancy" class="form-input" value="85" min="65" max="120" step="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Expected Return (%)</label>
                                    <input type="number" id="expectedReturn" class="form-input" value="7" min="0" max="20" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Inflation Rate (%)</label>
                                    <input type="number" id="inflationRate" class="form-input" value="3" min="0" max="10" step="0.1">
                                </div>
                            </div>
                        </div>

                        <div class="flex space-x-4">
                            <button onclick="calculateRetirement()" class="btn-primary flex-1">Plan Retirement</button>
                            <button onclick="resetRetirementForm()" class="btn-secondary">Reset</button>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div id="retirementResults" class="result-card">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Retirement Analysis</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div class="text-center">
                                    <div class="result-value" id="projectedSavings">$0</div>
                                    <div class="result-label">Projected Savings</div>
                                </div>
                                <div class="text-center">
                                    <div class="result-value" id="retirementNeeds">$0</div>
                                    <div class="result-label">Total Needed</div>
                                </div>
                            </div>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span>Surplus/Shortfall:</span>
                                    <span id="surplusShortfall" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Monthly Income at Retirement:</span>
                                    <span id="monthlyRetirementIncome" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Years to Retirement:</span>
                                    <span id="yearsToRetirement" class="font-semibold">0</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Savings Growth</h3>
                            <canvas id="retirementChart" height="250"></canvas>
                        </div>

                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Recommendations</h3>
                            <div id="retirementRecommendations" class="space-y-2 text-sm">
                                <!-- Recommendations will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Generic Calculator HTML (for calculators not yet fully implemented)
        function getGenericCalculatorHTML(calculatorKey) {
            const calculator = calculators[calculatorKey];
            return `
                <div class="text-center py-12">
                    <div class="mx-auto w-24 h-24 bg-primary-100 dark:bg-primary-900 rounded-full flex items-center justify-center mb-6">
                        <svg class="w-12 h-12 text-primary-600 dark:text-primary-400" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V5H19V19Z"/>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">${calculator.title}</h3>
                    <p class="text-gray-600 dark:text-gray-300 mb-8 max-w-md mx-auto">${calculator.description}</p>
                    <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-6 mb-8">
                        <h4 class="text-lg font-semibold text-blue-800 dark:text-blue-200 mb-2">Coming Soon!</h4>
                        <p class="text-blue-700 dark:text-blue-300">This calculator is currently under development. We're working hard to bring you the most accurate and user-friendly financial tools.</p>
                    </div>
                    <div class="space-y-4">
                        <button onclick="closeCalculatorModal()" class="btn-primary">Back to Calculators</button>
                        <p class="text-sm text-gray-500 dark:text-gray-400">
                            Need this calculator urgently? 
                            <a href="#" class="text-primary-600 dark:text-primary-400 hover:underline">Contact us</a> to prioritize its development.
                        </p>
                    </div>
                </div>
            `;
        }

        // Calculator Initialization
        function initializeCalculator(calculatorKey) {
            switch(calculatorKey) {
                case 'mortgage':
                    initializeMortgageCalculator();
                    break;
                case 'investment':
                    initializeInvestmentCalculator();
                    break;
                case 'retirement':
                    initializeRetirementCalculator();
                    break;
            }
        }

        // Mortgage Calculator Functions
        function initializeMortgageCalculator() {
            // Add event listeners for real-time calculations
            const inputs = ['homePrice', 'downPayment', 'downPaymentPercent', 'interestRate', 'loanTerm'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', () => {
                        updateDownPaymentFields();
                        calculateMortgage();
                    });
                }
            });
            
            // Initialize with default calculation
            updateDownPaymentFields();
            calculateMortgage();
        }

        function updateDownPaymentFields() {
            const homePrice = parseFloat(document.getElementById('homePrice').value) || 0;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const downPaymentPercent = parseFloat(document.getElementById('downPaymentPercent').value) || 0;
            
            // Update based on which field was changed last
            if (document.activeElement.id === 'downPayment') {
                const percentage = (downPayment / homePrice) * 100;
                document.getElementById('downPaymentPercent').value = percentage.toFixed(1);
            } else if (document.activeElement.id === 'downPaymentPercent') {
                const amount = homePrice * (downPaymentPercent / 100);
                document.getElementById('downPayment').value = amount.toFixed(0);
            }
            
            // Update loan amount
            const finalDownPayment = parseFloat(document.getElementById('downPayment').value) || 0;
         const loanAmount = homePrice - finalDownPayment;
            document.getElementById('loanAmount').value = loanAmount.toFixed(0);
        }

        function calculateMortgage() {
            const homePrice = parseFloat(document.getElementById('homePrice').value) || 0;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
            const loanTerm = parseFloat(document.getElementById('loanTerm').value) || 30;
            const propertyTax = parseFloat(document.getElementById('propertyTax').value) || 0;
            const homeInsurance = parseFloat(document.getElementById('homeInsurance').value) || 0;
            const pmi = parseFloat(document.getElementById('pmi').value) || 0;
            const hoaFees = parseFloat(document.getElementById('hoaFees').value) || 0;

            const principal = homePrice - downPayment;
            const monthlyRate = interestRate / 100 / 12;
            const numberOfPayments = loanTerm * 12;

            if (principal <= 0 || interestRate <= 0) {
                resetMortgageResults();
                return;
            }

            // Calculate monthly payment (Principal & Interest)
            const monthlyPayment = principal * 
                (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / 
                (Math.pow(1 + monthlyRate, numberOfPayments) - 1);

            // Additional monthly costs
            const monthlyPropertyTax = propertyTax / 12;
            const monthlyInsurance = homeInsurance / 12;
            const totalMonthlyPayment = monthlyPayment + monthlyPropertyTax + monthlyInsurance + pmi + hoaFees;

            // Total calculations
            const totalInterest = (monthlyPayment * numberOfPayments) - principal;
            const totalPayments = monthlyPayment * numberOfPayments;

            // Payoff date
            const today = new Date();
            const payoffDate = new Date(today.getFullYear() + loanTerm, today.getMonth(), today.getDate());

            // Update UI
            document.getElementById('monthlyPayment').textContent = formatCurrency(monthlyPayment);
            document.getElementById('totalMonthlyPayment').textContent = formatCurrency(totalMonthlyPayment);
            document.getElementById('piPayment').textContent = formatCurrency(monthlyPayment);
            document.getElementById('monthlyPropertyTax').textContent = formatCurrency(monthlyPropertyTax);
            document.getElementById('monthlyInsurance').textContent = formatCurrency(monthlyInsurance);
            document.getElementById('monthlyPMI').textContent = formatCurrency(pmi);
            document.getElementById('monthlyHOA').textContent = formatCurrency(hoaFees);
            document.getElementById('totalInterest').textContent = formatCurrency(totalInterest);
            document.getElementById('totalPayments').textContent = formatCurrency(totalPayments);
            document.getElementById('payoffDate').textContent = payoffDate.toLocaleDateString();

            // Generate amortization preview
            generateAmortizationPreview(principal, monthlyRate, numberOfPayments, monthlyPayment);

            // Generate chart
            generateMortgageChart(principal, totalInterest);
        }

        function generateAmortizationPreview(principal, monthlyRate, numberOfPayments, monthlyPayment) {
            const preview = document.getElementById('amortizationPreview');
            let balance = principal;
            let html = `
                <table class="w-full text-sm">
                    <thead class="bg-gray-50 dark:bg-gray-600">
                        <tr>
                            <th class="px-3 py-2 text-left">Payment #</th>
                            <th class="px-3 py-2 text-right">Interest</th>
                            <th class="px-3 py-2 text-right">Principal</th>
                            <th class="px-3 py-2 text-right">Balance</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
            `;

            for (let i = 1; i <= Math.min(12, numberOfPayments); i++) {
                const interestPayment = balance * monthlyRate;
                const principalPayment = monthlyPayment - interestPayment;
                balance -= principalPayment;

                html += `
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                        <td class="px-3 py-2">${i}</td>
                        <td class="px-3 py-2 text-right">${formatCurrency(interestPayment)}</td>
                        <td class="px-3 py-2 text-right">${formatCurrency(principalPayment)}</td>
                        <td class="px-3 py-2 text-right">${formatCurrency(balance)}</td>
                    </tr>
                `;
            }

            html += '</tbody></table>';
            if (numberOfPayments > 12) {
                html += '<p class="text-xs text-gray-500 mt-2">Showing first 12 payments. Click "View Full Schedule" for complete amortization table.</p>';
            }
            
            preview.innerHTML = html;
        }

        function generateMortgageChart(principal, totalInterest) {
            const ctx = document.getElementById('mortgageChart');
            if (!ctx) return;

            // Destroy existing chart if it exists
            if (window.mortgageChartInstance) {
                window.mortgageChartInstance.destroy();
            }

            window.mortgageChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Principal', 'Interest'],
                    datasets: [{
                        data: [principal, totalInterest],
                        backgroundColor: [
                            '#3b82f6',
                            '#ef4444'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetMortgageForm() {
            document.getElementById('homePrice').value = '400000';
            document.getElementById('downPayment').value = '80000';
            document.getElementById('downPaymentPercent').value = '20';
            document.getElementById('interestRate').value = '6.5';
            document.getElementById('loanTerm').value = '30';
            document.getElementById('propertyTax').value = '6000';
            document.getElementById('homeInsurance').value = '1200';
            document.getElementById('pmi').value = '200';
            document.getElementById('hoaFees').value = '0';
            updateDownPaymentFields();
            calculateMortgage();
        }

        function resetMortgageResults() {
            document.getElementById('monthlyPayment').textContent = '$0';
            document.getElementById('totalMonthlyPayment').textContent = '$0';
            document.getElementById('piPayment').textContent = '$0';
            document.getElementById('monthlyPropertyTax').textContent = '$0';
            document.getElementById('monthlyInsurance').textContent = '$0';
            document.getElementById('monthlyPMI').textContent = '$0';
            document.getElementById('monthlyHOA').textContent = '$0';
            document.getElementById('totalInterest').textContent = '$0';
            document.getElementById('totalPayments').textContent = '$0';
            document.getElementById('payoffDate').textContent = '-';
            document.getElementById('amortizationPreview').innerHTML = '';
        }

        // Investment Calculator Functions
        function initializeInvestmentCalculator() {
            const inputs = ['initialInvestment', 'monthlyContribution', 'annualRate', 'investmentYears'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', calculateInvestment);
                }
            });
            calculateInvestment();
        }

        function calculateInvestment() {
            const initialInvestment = parseFloat(document.getElementById('initialInvestment').value) || 0;
            const monthlyContribution = parseFloat(document.getElementById('monthlyContribution').value) || 0;
            const annualRate = parseFloat(document.getElementById('annualRate').value) || 0;
            const years = parseFloat(document.getElementById('investmentYears').value) || 0;
            const compoundFreq = parseFloat(document.getElementById('compoundFreq').value) || 12;

            if (years <= 0) {
                resetInvestmentResults();
                return;
            }

            const monthlyRate = annualRate / 100 / 12;
            const totalMonths = years * 12;
            
            // Future value of initial investment
            const futureValueInitial = initialInvestment * Math.pow(1 + monthlyRate, totalMonths);
            
            // Future value of monthly contributions (annuity)
            const futureValueContributions = monthlyContribution * 
                ((Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate);
            
            const finalAmount = futureValueInitial + futureValueContributions;
            const totalContributions = initialInvestment + (monthlyContribution * totalMonths);
            const totalInterest = finalAmount - totalContributions;
            const totalReturn = totalContributions > 0 ? ((totalInterest / totalContributions) * 100) : 0;

            // Update UI
            document.getElementById('finalAmount').textContent = formatCurrency(finalAmount);
            document.getElementById('totalContributions').textContent = formatCurrency(totalContributions);
            document.getElementById('totalInterestEarned').textContent = formatCurrency(totalInterest);
            document.getElementById('totalReturn').textContent = totalReturn.toFixed(1) + '%';

            // Generate yearly breakdown
            generateYearlyBreakdown(initialInvestment, monthlyContribution, monthlyRate, years);

            // Generate chart
            generateInvestmentChart(initialInvestment, monthlyContribution, monthlyRate, years);
        }

        function generateYearlyBreakdown(initial, monthlyContrib, monthlyRate, years) {
            const breakdown = document.getElementById('yearlyBreakdown');
            let balance = initial;
            let totalContributions = initial;
            
            let html = `
                <table class="w-full text-sm">
                    <thead class="bg-gray-50 dark:bg-gray-600">
                        <tr>
                            <th class="px-3 py-2 text-left">Year</th>
                            <th class="px-3 py-2 text-right">Balance</th>
                            <th class="px-3 py-2 text-right">Annual Interest</th>
                            <th class="px-3 py-2 text-right">Total Interest</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
            `;

            let totalInterest = 0;

            for (let year = 1; year <= years; year++) {
                let yearStartBalance = balance;
                let yearInterest = 0;

                for (let month = 1; month <= 12; month++) {
                    const monthInterest = balance * monthlyRate;
                    balance += monthInterest + monthlyContrib;
                    yearInterest += monthInterest;
                    totalContributions += monthlyContrib;
                }

                totalInterest += yearInterest;

                html += `
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                        <td class="px-3 py-2">${year}</td>
                        <td class="px-3 py-2 text-right font-medium">${formatCurrency(balance)}</td>
                        <td class="px-3 py-2 text-right text-green-600">${formatCurrency(yearInterest)}</td>
                        <td class="px-3 py-2 text-right text-green-600">${formatCurrency(totalInterest)}</td>
                    </tr>
                `;
            }

            html += '</tbody></table>';
            breakdown.innerHTML = html;
        }

        function generateInvestmentChart(initial, monthlyContrib, monthlyRate, years) {
            const ctx = document.getElementById('investmentChart');
            if (!ctx) return;

            if (window.investmentChartInstance) {
                window.investmentChartInstance.destroy();
            }

            const data = [];
            const labels = [];
            let balance = initial;
            let contributions = initial;

            // Add initial point
            data.push({ x: 0, y: balance, contributions: initial });
            labels.push('Start');

            for (let year = 1; year <= years; year++) {
                for (let month = 1; month <= 12; month++) {
                    balance = balance * (1 + monthlyRate) + monthlyContrib;
                    contributions += monthlyContrib;
                }
                data.push({ x: year, y: balance, contributions: contributions });
                labels.push(`Year ${year}`);
            }

            window.investmentChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Total Balance',
                        data: data,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Years'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Amount ($)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Balance: ${formatCurrency(context.raw.y)}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetInvestmentForm() {
            document.getElementById('initialInvestment').value = '10000';
            document.getElementById('monthlyContribution').value = '500';
            document.getElementById('annualRate').value = '8';
            document.getElementById('investmentYears').value = '20';
            document.getElementById('compoundFreq').value = '12';
            calculateInvestment();
        }

        function resetInvestmentResults() {
            document.getElementById('finalAmount').textContent = '$0';
            document.getElementById('totalContributions').textContent = '$0';
            document.getElementById('totalInterestEarned').textContent = '$0';
            document.getElementById('totalReturn').textContent = '0%';
            document.getElementById('yearlyBreakdown').innerHTML = '';
        }

        // Retirement Calculator Functions
        function initializeRetirementCalculator() {
            const inputs = ['currentAge', 'retirementAge', 'currentSavings', 'monthlyRetirementContrib', 'desiredIncome', 'lifeExpectancy', 'expectedReturn', 'inflationRate'];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', calculateRetirement);
                }
            });
            calculateRetirement();
        }

        function calculateRetirement() {
            const currentAge = parseInt(document.getElementById('currentAge').value) || 30;
            const retirementAge = parseInt(document.getElementById('retirementAge').value) || 65;
            const currentSavings = parseFloat(document.getElementById('currentSavings').value) || 0;
            const monthlyContrib = parseFloat(document.getElementById('monthlyRetirementContrib').value) || 0;
            const desiredIncome = parseFloat(document.getElementById('desiredIncome').value) || 0;
            const lifeExpectancy = parseInt(document.getElementById('lifeExpectancy').value) || 85;
            const expectedReturn = parseFloat(document.getElementById('expectedReturn').value) || 7;
            const inflationRate = parseFloat(document.getElementById('inflationRate').value) || 3;

            if (retirementAge <= currentAge) {
                resetRetirementResults();
                return;
            }

            const yearsToRetirement = retirementAge - currentAge;
            const yearsInRetirement = lifeExpectancy - retirementAge;
            const monthlyRate = expectedReturn / 100 / 12;
            const monthsToRetirement = yearsToRetirement * 12;

            // Calculate projected savings at retirement
            const futureValueCurrent = currentSavings * Math.pow(1 + monthlyRate, monthsToRetirement);
            const futureValueContribs = monthlyContrib * 
                ((Math.pow(1 + monthlyRate, monthsToRetirement) - 1) / monthlyRate);
            const projectedSavings = futureValueCurrent + futureValueContribs;

            // Calculate needed savings (accounting for inflation)
            const inflatedIncome = desiredIncome * Math.pow(1 + inflationRate / 100, yearsToRetirement);
            const annualIncomeNeeded = inflatedIncome;
            
            // Using 4% withdrawal rule adjusted for inflation
            const withdrawalRate = (expectedReturn - inflationRate) / 100;
            const totalNeeded = annualIncomeNeeded / withdrawalRate;

            const surplusShortfall = projectedSavings - totalNeeded;
            const monthlyIncomeAtRetirement = (projectedSavings * withdrawalRate) / 12;

            // Update UI
            document.getElementById('projectedSavings').textContent = formatCurrency(projectedSavings);
            document.getElementById('retirementNeeds').textContent = formatCurrency(totalNeeded);
            document.getElementById('surplusShortfall').textContent = formatCurrency(surplusShortfall);
            document.getElementById('monthlyRetirementIncome').textContent = formatCurrency(monthlyIncomeAtRetirement);
            document.getElementById('yearsToRetirement').textContent = yearsToRetirement;

            // Color code surplus/shortfall
            const surplusElement = document.getElementById('surplusShortfall');
            if (surplusShortfall >= 0) {
                surplusElement.className = 'font-semibold text-green-600';
            } else {
                surplusElement.className = 'font-semibold text-red-600';
            }

            // Generate recommendations
            generateRetirementRecommendations(surplusShortfall, monthlyContrib, totalNeeded, projectedSavings, yearsToRetirement);

            // Generate chart
            generateRetirementChart(currentSavings, monthlyContrib, monthlyRate, yearsToRetirement);
        }

        function generateRetirementRecommendations(shortfall, currentContrib, needed, projected, years) {
            const recommendations = document.getElementById('retirementRecommendations');
            let html = '';

            if (shortfall >= 0) {
                html = `
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                        <h5 class="font-semibold text-green-800 dark:text-green-200 mb-2">Great Job! </h5>
                        <p class="text-green-700 dark:text-green-300">You're on track to meet your retirement goals. Consider:</p>
                        <ul class="list-disc list-inside mt-2 text-green-700 dark:text-green-300 text-sm space-y-1">
                            <li>Increasing contributions to build a larger cushion</li>
                            <li>Diversifying your investment portfolio</li>
                            <li>Regular reviews to stay on track</li>
                        </ul>
                    </div>
                `;
            } else {
                const additionalNeeded = Math.abs(shortfall);
                const additionalMonthly = additionalNeeded / (((Math.pow(1.07 / 12 + 1, years * 12) - 1) / (0.07 / 12)));
                
                html = `
                    <div class="bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-4">
                        <h5 class="font-semibold text-red-800 dark:text-red-200 mb-2">Action Needed </h5>
                        <p class="text-red-700 dark:text-red-300 mb-2">You have a shortfall of ${formatCurrency(additionalNeeded)}. Consider:</p>
                        <ul class="list-disc list-inside text-red-700 dark:text-red-300 text-sm space-y-1">
                            <li>Increase monthly savings by ${formatCurrency(additionalMonthly)}</li>
                            <li>Work ${Math.ceil(Math.abs(shortfall) / (currentContrib * 12))} additional years</li>
                            <li>Reduce retirement expenses by ${formatCurrency((additionalNeeded * 0.04) / 12)}/month</li>
                            <li>Consider higher-yield investments (with appropriate risk)</li>
                        </ul>
                    </div>
                `;
            }

            recommendations.innerHTML = html;
        }

        function generateRetirementChart(currentSavings, monthlyContrib, monthlyRate, years) {
            const ctx = document.getElementById('retirementChart');
            if (!ctx) return;

            if (window.retirementChartInstance) {
                window.retirementChartInstance.destroy();
            }

            const contributionsData = [];
            const growthData = [];
            const labels = [];
            
            let balance = currentSavings;
            let totalContributions = currentSavings;

            contributionsData.push(currentSavings);
            growthData.push(currentSavings);
            labels.push('Now');

            for (let year = 1; year <= years; year++) {
                for (let month = 1; month <= 12; month++) {
                    balance = balance * (1 + monthlyRate) + monthlyContrib;
                    totalContributions += monthlyContrib;
                }
                contributionsData.push(totalContributions);
                growthData.push(balance);
                labels.push(`Year ${year}`);
            }

            window.retirementChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Total Contributions',
                            data: contributionsData,
                            borderColor: '#6b7280',
                            backgroundColor: 'rgba(107, 114, 128, 0.1)',
                            fill: false
                        },
                        {
                            label: 'Total with Growth',
                            data: growthData,
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Time'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Amount ($)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${formatCurrency(context.raw)}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetRetirementForm() {
            document.getElementById('currentAge').value = '30';
            document.getElementById('retirementAge').value = '65';
            document.getElementById('currentSavings').value = '50000';
            document.getElementById('monthlyRetirementContrib').value = '1000';
            document.getElementById('desiredIncome').value = '60000';
            document.getElementById('lifeExpectancy').value = '85';
            document.getElementById('expectedReturn').value = '7';
            document.getElementById('inflationRate').value = '3';
            calculateRetirement();
        }

        function resetRetirementResults() {
            document.getElementById('projectedSavings').textContent = '$0';
            document.getElementById('retirementNeeds').textContent = '$0';
            document.getElementById('surplusShortfall').textContent = '$0';
            document.getElementById('monthlyRetirementIncome').textContent = '$0';
            document.getElementById('yearsToRetirement').textContent = '0';
            document.getElementById('retirementRecommendations').innerHTML = '';
        }

        // Utility Functions
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function formatPercent(value, decimals = 1) {
            return value.toFixed(decimals) + '%';
        }

        function showFullAmortization() {
            alert('Full amortization schedule feature coming soon! This will open a detailed view with the complete payment schedule.');
        }

        function printResults() {
            window.print();
        }

        // Favorites Management
        function toggleFavorite(calculatorKey) {
            let favorites = JSON.parse(localStorage.getItem('favoriteCalculators') || '[]');
            const index = favorites.indexOf(calculatorKey);
            
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(calculatorKey);
            }
            
            localStorage.setItem('favoriteCalculators', JSON.stringify(favorites));
            updateFavoriteIcon(calculatorKey);
        }

        function updateFavoriteIcon(calculatorKey) {
            const favorites = JSON.parse(localStorage.getItem('favoriteCalculators') || '[]');
            const cards = document.querySelectorAll(`[onclick*="${calculatorKey}"]`);
            
            cards.forEach(card => {
                const favoriteBtn = card.querySelector('button[onclick*="toggleFavorite"]');
                if (favoriteBtn) {
                    const svg = favoriteBtn.querySelector('svg');
                    if (favorites.includes(calculatorKey)) {
                        svg.setAttribute('fill', 'currentColor');
                        favoriteBtn.classList.add('text-red-500');
                        favoriteBtn.classList.remove('text-gray-400');
                    } else {
                        svg.setAttribute('fill', 'none');
                        favoriteBtn.classList.remove('text-red-500');
                        favoriteBtn.classList.add('text-gray-400');
                    }
                }
            });
        }

        // Recent Calculations Management
        function saveToRecent(calculatorKey) {
            let recent = JSON.parse(localStorage.getItem('recentCalculators') || '[]');
            recent = recent.filter(key => key !== calculatorKey);
            recent.unshift(calculatorKey);
            recent = recent.slice(0, 5); // Keep only 5 recent
            localStorage.setItem('recentCalculators', JSON.stringify(recent));
        }

        function loadRecentCalculations() {
            const recent = JSON.parse(localStorage.getItem('recentCalculators') || '[]');
            // Could add a recent calculations section to the UI
        }

        // PWA Functions
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'k':
                        e.preventDefault();
                        document.getElementById('searchInput').focus();
                        break;
                    case 'Enter':
                        if (currentCalculator) {
                            e.preventDefault();
                            // Trigger calculation for current calculator
                            switch(currentCalculator) {
                                case 'mortgage':
                                    calculateMortgage();
                                    break;
                                case 'investment':
                                    calculateInvestment();
                                    break;
                                case 'retirement':
                                    calculateRetirement();
                                    break;
                            }
                        }
                        break;
                }
            }
        });

        // Add smooth scroll behavior for navigation links
        document.addEventListener('click', function(e) {
            if (e.target.matches('a[href^="#"]')) {
                e.preventDefault();
                const target = document.querySelector(e.target.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            }
        });

        // Initialize favorites on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                Object.keys(calculators).forEach(key => {
                    updateFavoriteIcon(key);
                });
            }, 100);
        });

        // Export functionality
        function exportResults() {
            // Implementation for exporting results to PDF/Excel
            console.log('Export functionality will be implemented');
        }

        // Share functionality
        function shareResults() {
            if (navigator.share) {
                navigator.share({
                    title: 'Financial Calculator Results',
                    text: 'Check out my financial calculation results',
                    url: window.location.href
                });
            } else {
                // Fallback to copy link
                navigator.clipboard.writeText(window.location.href);
                alert('Link copied to clipboard!');
            }
        }

        // Add loading states
        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = '<div class="animate-pulse">Calculating...</div>';
            }
        }

        function hideLoading(elementId, content) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = content;
            }
        }

        // Auto-save functionality
        function autoSave() {
            const formData = {};
            const inputs = document.querySelectorAll('input, select');
            inputs.forEach(input => {
                if (input.id) {
                    formData[input.id] = input.value;
                }
            });
            if (currentCalculator) {
             localStorage.setItem(`autosave_${currentCalculator}`, JSON.stringify(formData));
            }
        }

        function loadAutoSave() {
            if (currentCalculator) {
                const saved = localStorage.getItem(`autosave_${currentCalculator}`);
                if (saved) {
                    const formData = JSON.parse(saved);
                    Object.keys(formData).forEach(id => {
                        const element = document.getElementById(id);
                        if (element) {
                            element.value = formData[id];
                        }
                    });
                }
            }
        }

        // Add auto-save on input change
        document.addEventListener('input', function(e) {
            if (e.target.matches('input, select')) {
                clearTimeout(window.autoSaveTimeout);
                window.autoSaveTimeout = setTimeout(autoSave, 1000);
            }
        });

        // Comparison functionality
        function showComparison() {
            // Implementation for comparing multiple scenarios
            console.log('Comparison functionality will be implemented');
        }

        // Educational tooltips
        function addTooltips() {
            const tooltips = {
                'interestRate': 'The annual percentage rate (APR) for your loan',
                'downPayment': 'The upfront payment made when purchasing a home',
                'pmi': 'Private Mortgage Insurance - required when down payment is less than 20%',
                'compoundFreq': 'How often interest is calculated and added to your balance',
                'expectedReturn': 'The average annual return you expect from your investments',
                'inflationRate': 'The rate at which prices increase over time'
            };

            Object.keys(tooltips).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.title = tooltips[id];
                    element.setAttribute('data-tooltip', tooltips[id]);
                }
            });
        }

        // Add compound interest calculator
        function getCompoundInterestCalculatorHTML() {
            return `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Investment Details</h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">Principal Amount ($)</label>
                                    <input type="number" id="compoundPrincipal" class="form-input" value="5000" min="0" step="100">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Annual Interest Rate (%)</label>
                                    <input type="number" id="compoundRate" class="form-input" value="7" min="0" max="50" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Time Period (years)</label>
                                    <input type="number" id="compoundTime" class="form-input" value="10" min="1" max="50" step="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Compounding Frequency</label>
                                    <select id="compoundFrequency" class="form-input">
                                        <option value="1">Annually</option>
                                        <option value="2">Semi-annually</option>
                                        <option value="4">Quarterly</option>
                                        <option value="12" selected>Monthly</option>
                                        <option value="52">Weekly</option>
                                        <option value="365">Daily</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="flex space-x-4">
                            <button onclick="calculateCompoundInterest()" class="btn-primary flex-1">Calculate</button>
                            <button onclick="resetCompoundForm()" class="btn-secondary">Reset</button>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div id="compoundResults" class="result-card">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Compound Interest Results</h3>
                            <div class="text-center mb-4">
                                <div class="result-value" id="compoundFinalAmount">$0</div>
                                <div class="result-label">Final Amount</div>
                            </div>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span>Principal:</span>
                                    <span id="compoundPrincipalDisplay">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Interest Earned:</span>
                                    <span id="compoundInterestEarned" class="font-semibold text-green-600">$0</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Growth Visualization</h3>
                            <canvas id="compoundChart" height="200"></canvas>
                        </div>
                    </div>
                </div>
            `;
        }

        // Compound Interest Calculator Functions
        function calculateCompoundInterest() {
            const principal = parseFloat(document.getElementById('compoundPrincipal').value) || 0;
            const rate = parseFloat(document.getElementById('compoundRate').value) || 0;
            const time = parseFloat(document.getElementById('compoundTime').value) || 0;
            const frequency = parseFloat(document.getElementById('compoundFrequency').value) || 12;

            if (principal <= 0 || rate <= 0 || time <= 0) {
                resetCompoundResults();
                return;
            }

            // Compound interest formula: A = P(1 + r/n)^(nt)
            const finalAmount = principal * Math.pow(1 + (rate / 100) / frequency, frequency * time);
            const interestEarned = finalAmount - principal;

            document.getElementById('compoundFinalAmount').textContent = formatCurrency(finalAmount);
            document.getElementById('compoundPrincipalDisplay').textContent = formatCurrency(principal);
            document.getElementById('compoundInterestEarned').textContent = formatCurrency(interestEarned);

            generateCompoundChart(principal, rate, time, frequency);
        }

        function generateCompoundChart(principal, rate, time, frequency) {
            const ctx = document.getElementById('compoundChart');
            if (!ctx) return;

            if (window.compoundChartInstance) {
                window.compoundChartInstance.destroy();
            }

            const data = [];
            const labels = [];
            
            for (let year = 0; year <= time; year++) {
                const amount = principal * Math.pow(1 + (rate / 100) / frequency, frequency * year);
                data.push(amount);
                labels.push(`Year ${year}`);
            }

            window.compoundChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Investment Value',
                        data: data,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Value: ${formatCurrency(context.raw)}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetCompoundForm() {
            document.getElementById('compoundPrincipal').value = '5000';
            document.getElementById('compoundRate').value = '7';
            document.getElementById('compoundTime').value = '10';
            document.getElementById('compoundFrequency').value = '12';
            calculateCompoundInterest();
        }

        function resetCompoundResults() {
            document.getElementById('compoundFinalAmount').textContent = '$0';
            document.getElementById('compoundPrincipalDisplay').textContent = '$0';
            document.getElementById('compoundInterestEarned').textContent = '$0';
        }

        // Loan Calculator Functions
        function getLoanCalculatorHTML() {
            return `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Loan Information</h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">Loan Amount ($)</label>
                                    <input type="number" id="loanPrincipal" class="form-input" value="25000" min="0" step="1000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Interest Rate (% per year)</label>
                                    <input type="number" id="loanRate" class="form-input" value="5.5" min="0" max="30" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Loan Term</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        <input type="number" id="loanTermValue" class="form-input" value="5" min="1" step="1">
                                        <select id="loanTermUnit" class="form-input">
                                            <option value="years">Years</option>
                                            <option value="months">Months</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex space-x-4">
                            <button onclick="calculateLoan()" class="btn-primary flex-1">Calculate Payment</button>
                            <button onclick="resetLoanForm()" class="btn-secondary">Reset</button>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div id="loanResults" class="result-card">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Loan Payment Results</h3>
                            <div class="text-center mb-4">
                                <div class="result-value" id="loanMonthlyPayment">$0</div>
                                <div class="result-label">Monthly Payment</div>
                            </div>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span>Total Interest:</span>
                                    <span id="loanTotalInterest" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Total of Payments:</span>
                                    <span id="loanTotalPayments" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Number of Payments:</span>
                                    <span id="loanNumberPayments" class="font-semibold">0</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Payment Breakdown</h3>
                            <canvas id="loanChart" height="200"></canvas>
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateLoan() {
            const principal = parseFloat(document.getElementById('loanPrincipal').value) || 0;
            const annualRate = parseFloat(document.getElementById('loanRate').value) || 0;
            const termValue = parseFloat(document.getElementById('loanTermValue').value) || 0;
            const termUnit = document.getElementById('loanTermUnit').value;

            if (principal <= 0 || annualRate <= 0 || termValue <= 0) {
                resetLoanResults();
                return;
            }

            const monthlyRate = annualRate / 100 / 12;
            const numberOfPayments = termUnit === 'years' ? termValue * 12 : termValue;

            const monthlyPayment = principal * 
                (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / 
                (Math.pow(1 + monthlyRate, numberOfPayments) - 1);

            const totalPayments = monthlyPayment * numberOfPayments;
            const totalInterest = totalPayments - principal;

            document.getElementById('loanMonthlyPayment').textContent = formatCurrency(monthlyPayment);
            document.getElementById('loanTotalInterest').textContent = formatCurrency(totalInterest);
            document.getElementById('loanTotalPayments').textContent = formatCurrency(totalPayments);
            document.getElementById('loanNumberPayments').textContent = numberOfPayments;

            generateLoanChart(principal, totalInterest);
        }

        function generateLoanChart(principal, totalInterest) {
            const ctx = document.getElementById('loanChart');
            if (!ctx) return;

            if (window.loanChartInstance) {
                window.loanChartInstance.destroy();
            }

            window.loanChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Principal', 'Interest'],
                    datasets: [{
                        data: [principal, totalInterest],
                        backgroundColor: ['#3b82f6', '#ef4444'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetLoanForm() {
            document.getElementById('loanPrincipal').value = '25000';
            document.getElementById('loanRate').value = '5.5';
            document.getElementById('loanTermValue').value = '5';
            document.getElementById('loanTermUnit').value = 'years';
            calculateLoan();
        }

        function resetLoanResults() {
            document.getElementById('loanMonthlyPayment').textContent = '$0';
            document.getElementById('loanTotalInterest').textContent = '$0';
            document.getElementById('loanTotalPayments').textContent = '$0';
            document.getElementById('loanNumberPayments').textContent = '0';
        }

        // Savings Calculator Functions
        function getSavingsCalculatorHTML() {
            return `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Savings Goal</h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">Savings Goal ($)</label>
                                    <input type="number" id="savingsGoal" class="form-input" value="50000" min="0" step="1000">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Current Savings ($)</label>
                                    <input type="number" id="currentSavingsAmount" class="form-input" value="10000" min="0" step="100">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Monthly Deposit ($)</label>
                                    <input type="number" id="monthlyDeposit" class="form-input" value="500" min="0" step="50">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Interest Rate (% per year)</label>
                                    <input type="number" id="savingsRate" class="form-input" value="4" min="0" max="20" step="0.1">
                                </div>
                            </div>
                        </div>
                        <div class="flex space-x-4">
                            <button onclick="calculateSavings()" class="btn-primary flex-1">Calculate Timeline</button>
                            <button onclick="resetSavingsForm()" class="btn-secondary">Reset</button>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div id="savingsResults" class="result-card">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Savings Plan Results</h3>
                            <div class="text-center mb-4">
                                <div class="result-value" id="savingsTimeToGoal">0</div>
                                <div class="result-label">Months to Goal</div>
                            </div>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between">
                                    <span>Goal Date:</span>
                                    <span id="savingsGoalDate" class="font-semibold">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Total Deposits:</span>
                                    <span id="savingsTotalDeposits" class="font-semibold">$0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Interest Earned:</span>
                                    <span id="savingsInterestEarned" class="font-semibold text-green-600">$0</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Savings Progress</h3>
                            <canvas id="savingsChart" height="200"></canvas>
                        </div>
                    </div>
                </div>
            `;
        }

        function calculateSavings() {
            const goal = parseFloat(document.getElementById('savingsGoal').value) || 0;
            const currentAmount = parseFloat(document.getElementById('currentSavingsAmount').value) || 0;
            const monthlyDeposit = parseFloat(document.getElementById('monthlyDeposit').value) || 0;
            const annualRate = parseFloat(document.getElementById('savingsRate').value) || 0;

            if (goal <= currentAmount || monthlyDeposit <= 0) {
                resetSavingsResults();
                return;
            }

            const monthlyRate = annualRate / 100 / 12;
            let balance = currentAmount;
            let months = 0;
            let totalDeposits = currentAmount;

            // Calculate months needed to reach goal
            while (balance < goal && months < 1000) { // Safety limit
                balance = balance * (1 + monthlyRate) + monthlyDeposit;
                totalDeposits += monthlyDeposit;
                months++;
            }

            const interestEarned = balance - totalDeposits;
            const goalDate = new Date();
            goalDate.setMonth(goalDate.getMonth() + months);

            document.getElementById('savingsTimeToGoal').textContent = months;
            document.getElementById('savingsGoalDate').textContent = goalDate.toLocaleDateString();
            document.getElementById('savingsTotalDeposits').textContent = formatCurrency(totalDeposits);
            document.getElementById('savingsInterestEarned').textContent = formatCurrency(interestEarned);

            generateSavingsChart(currentAmount, monthlyDeposit, monthlyRate, months);
        }

        function generateSavingsChart(initial, monthly, rate, months) {
            const ctx = document.getElementById('savingsChart');
            if (!ctx) return;

            if (window.savingsChartInstance) {
                window.savingsChartInstance.destroy();
            }

            const data = [];
            const labels = [];
            let balance = initial;

            data.push(balance);
            labels.push('Start');

            for (let month = 1; month <= months; month++) {
                balance = balance * (1 + rate) + monthly;
                data.push(balance);
                labels.push(`Month ${month}`);
            }

            window.savingsChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Savings Balance',
                        data: data,
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Balance: ${formatCurrency(context.raw)}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetSavingsForm() {
            document.getElementById('savingsGoal').value = '50000';
            document.getElementById('currentSavingsAmount').value = '10000';
            document.getElementById('monthlyDeposit').value = '500';
            document.getElementById('savingsRate').value = '4';
            calculateSavings();
        }

        function resetSavingsResults() {
            document.getElementById('savingsTimeToGoal').textContent = '0';
            document.getElementById('savingsGoalDate').textContent = '-';
            document.getElementById('savingsTotalDeposits').textContent = '$0';
            document.getElementById('savingsInterestEarned').textContent = '$0';
        }

        // PWA Manifest
        const manifest = {
            name: "Financial Calculator Pro",
            short_name: "FinCalc Pro",
            description: "Professional financial calculators for all your planning needs",
            start_url: "/",
            display: "standalone",
            background_color: "#ffffff",
            theme_color: "#3b82f6",
            icons: [
                {
                    src: "/icon-192.png",
                    sizes: "192x192",
                    type: "image/png"
                },
                {
                    src: "/icon-512.png",
                    sizes: "512x512",
                    type: "image/png"
                }
            ]
        };

        // Service Worker for PWA
        const serviceWorkerCode = `
            const CACHE_NAME = 'financial-calculator-v1';
            const urlsToCache = [
                '/',
                '/styles.css',
                '/script.js',
                'https://cdn.tailwindcss.com',
                'https://cdn.jsdelivr.net/npm/chart.js'
            ];

            self.addEventListener('install', event => {
                event.waitUntil(
                    caches.open(CACHE_NAME)
                        .then(cache => cache.addAll(urlsToCache))
                );
            });

            self.addEventListener('fetch', event => {
                event.respondWith(
                    caches.match(event.request)
                        .then(response => {
                            if (response) {
                                return response;
                            }
                            return fetch(event.request);
                        })
                );
            });
        `;

        // Initialize tooltips on calculator load
        function initializeTooltips() {
            addTooltips();
            
            // Create tooltip element
            const tooltip = document.createElement('div');
            tooltip.id = 'tooltip';
            tooltip.className = 'absolute z-50 px-2 py-1 text-xs text-white bg-gray-900 rounded opacity-0 pointer-events-none transition-opacity duration-200';
            document.body.appendChild(tooltip);

            // Add tooltip event listeners
            document.addEventListener('mouseover', function(e) {
                if (e.target.hasAttribute('data-tooltip')) {
                    const tooltipText = e.target.getAttribute('data-tooltip');
                    tooltip.textContent = tooltipText;
                    tooltip.style.opacity = '1';
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (e.target.hasAttribute('data-tooltip')) {
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 30 + 'px';
                }
            });

            document.addEventListener('mouseout', function(e) {
                if (e.target.hasAttribute('data-tooltip')) {
                    tooltip.style.opacity = '0';
                }
            });
        }

        // Call initialization functions when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeTooltips, 500);
        });
    </script>
</body>
</html>